# SLICER: Sequenced Long-read Identifier of Complex Element Regions

**A bioinformatics pipeline for analyzing complex engineered DNA constructs from PacBio/ONT long-read sequencing data, specializing in Golden Gate (and similar) assemblies with optional *de novo* reference generation.**

[Link to Publication - *Nature Computational Science* / *Briefings in Bioinformatics* (Coming Soon!)] [Link to Wiki](https://github.com/your-username/slicer/wiki) [Link to Issues](https://github.com/your-username/slicer/issues) 

This work is licensed under the CC BY-NC 4.0 license. It is free for academic use. For commercial use reach out.

## Overview

SLICER (Sequenced Long-read Identifier of Complex Element Regions) is a robust bioinformatics tool designed to process and analyze Pacific Biosciences (PacBio) or Oxford Nanopore Technologies (ONT) long-read sequencing data, particularly from libraries of engineered DNA constructs such as those generated by Golden Gate assembly.

Modern synthetic biology and genome editing workflows often involve creating complex DNA constructs (e.g., plasmids, viral vectors) with multiple functional elements - such as those found in Golden Gate Assemblies. Validating these constructs/cassettes/functional elements, especially when pooled or barcoded, presents significant bioinformatic challenges.

SLICER addresses these challenges by:

* **Dynamically Identifying Elements:** Accurately locating and extracting user-defined "anchor" sequences and the intervening regions of interest (ROIs), such as barcodes and core sequences, on a per-read basis. This accommodates positional variability common in engineered constructs.
* **Robust Demultiplexing:** Assigning reads to their respective constructs, even in complex, pooled libraries.
* ***De Novo* Reference Prediction:** Uniquely, SLICER can generate reference sequences directly from the sequencing reads when prior references are unavailable or incomplete. It offers two distinct algorithms for this:
    * **Slope Method:** Leverages read count disparities to identify true sequences.
    * **Distance Method:** Uses Hamming and Levenshtein distances for sequence clustering.
* **Comprehensive Analysis & Reporting:** Providing detailed statistics on read processing, filtering, alignment quality, and quantification of constructs.

![fig1_design_schematic](https://github.com/user-attachments/assets/0ed6cac6-08bb-4761-bde1-4134805533e2)
## Figure 1: Library designs recognised by SLICER.



![fig2_workflow](https://github.com/user-attachments/assets/38f68a1b-648b-435d-9cc3-8e2a42228c2b)
## Figure 2: Simplied overview of SLICER's workflow


## Key Features

* **Long-Read Optimized:** Specifically designed for long-read sequenced molecules.
* **Anchor-Based Element Extraction:** Flexible identification of barcodes and core sequences using user-defined flanking sequences.
* **Reference-Based Analysis:** Supports analysis using a user-provided FASTA reference file.
* ***De Novo* Reference Generation:** Powerful "Slope" and "Distance" methods to create references when none exist.
* **Comprehensive Filtering:** Stringent read filtering based on anchor presence and barcode length consistency.
* **Alignment & Quantification:** Utilizes Minimap2 for alignment and provides detailed quantification reports using Qualimap2.
* **Detailed Reporting:** Generates statistics, Venn diagrams for filtering, and barcode/construct count summaries.
* **Command-Line Interface:** Flexible operation with clear arguments.
* **Open Source:** Free for academic use. Reach out if you require to use SLICER in comercial applications/research.

## Quick Start

### Main Prerequisites

Its strongly recommended to just use the installation script with the precompiled yml files. But if you really want to know what were installing, here are the main players...

* Python 3.x
* Minimap2
* SAMtools
* BamTools
* Qualimap

### Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/mbassalbioinformatics/slicer.git
    cd slicer
    ```

2.  **Run the installation script (recommended):**
    ```bash
    python slicer_installer.py
    ```
    
### Basic Usage

Prepare your input files:
* An unaligned BAM (`.ubam`) or compressed FASTQ (`.fq.gz`) file from PacBio sequencing.
* A configuration file (e.g., `config.tsv`) specifying anchor sequences and other parameters.

**Example `config.tsv`:**
```tsv
input	      /path/to/your/pacbio_reads.bam
outdir	      /path/to/output_directory/
setname	      my_experiment
# mapref      /path/to/your/reference.fasta      (Optional: provide if you have a reference)
# autoref     slope                            (Default if mapref not provided; or use 'distance')
thread	      8
config	      1                                # Corresponds to Design 1 in Figure 1 of the manuscript
lfs	      GTAATGTGGAAAGGACGAAACACCGCACCG     # Example Left Flanking Sequence
rfs	      GTTTCTTGAAAAAGTGGCACCGAGTCGGTA     # Example Right Flanking Sequence
bbs	      AGGAGCCACCATGGCCCCAAAGAAGAAGCG     # Example Right Backbone Start Sequence
slen	      20                               # Length of anchor sequences to match
```


To run SLICER, simply...
```bash
conda activate slicer
slicer.py --arglist config.tsv
```

Alternatively, if you do not have a config.tsv file made, you can specify each input argument to slicer directly. 
```bash
conda activate slicer
slicer.py <arguments>
```
|Command|Options|Description|
|--|--|--|
|--arglist| [file] | Path to the file containing the list of arguments for the command line. Each argument in this list will be overridden by the correponding flag argument directly provided in the command line. |
|--input| [file] | Path to the input unaligned BAM or compressed FASTQ file. Accepted extensions are .bam, .ubam, .fq.gz, and .fastq.gz (case insensitive). |
|--outdir| [directory] | Path to the directory where you want the results to be saved in. |
|--setname|	[string] | The prefix to label output and intermediate files (no space allowed). |
|--mapref| [file] | Path to the file containing the reference sequences to which all reads will be aligned. |
|--autoref| [slope / distance] | The method that will be used for automatic reference generation, which will be activated when mapping reference (mapref) is not provided. Choices are the “slope” and “distance” method. This will be ignored it --mapref is provided, and “slope” method will be chosen as default when --mapref is absent. |
|--thread| [integer] | Maximum number of processes to use. Default is half the maximum number of available cores in your system. |
|--config| [1 / 2] | The read configuration of the sequenced long reads construct. Choose 1 if the configuration is in BBS-CoreSeq-LFS-Barcode-RFS order. Choose 2 if the configuration is in LFS-Barcode-RFS-CoreSeq-BBS order. See Figure 1 for more details. |
|--bbs| [string] | Stands for the BackBone Sequence (Figure 1). Refers to the left BBS in read configuration 1.  Refers to the right BBS in read configuration 2. In read configuration 1, type in the X last bases of the left BBS, where X is equal or more than the given read identifiers search length (slen). In read configuration 2, type in the X first bases of the right BBS, where X is equal or more than the given read identifiers search length (slen). |
|--lfs| [string] | Stands for the Left Flanking Sequence (Figure 1). In read configuration 1, this must be the full length of the LFS. In read configuration 2, this can be the full length of the LFS, or can just be the X last bases of the LFS, where X is equal or more than the given read identifiers search length (slen). |
|--rfs| [string] | Stands for the Right Flanking Sequence (Figure 1). In read configuration 1, this can be the full length of the RFS, or can just be the X first bases of the RFS, where X is equal or more than the given read identifiers search length (slen). In read configuration 2, this must be the full length of the RFS. |
|--slen| [integer] | The read identifiers search length. Recommended value is 20 and above. SLICER will search every read for exact matches of the read identifier sequences (LFS, RFS, and BBS starts or ends) to locate read barcode and core sequence. As these are all based on first found exact matches, too short slen has a risk of unwanted matches (leading to false barcode or coreseq location), and too long has a risk of no matches (considering the high indel probability in PacBio long reads sequencing).


### Refer to the wiki pages for full details of method, usage etc...

### License
SLICER is licensed under the CC BY-NC 4.0 license. It is free for academic use. For commercial use reach out.

### Contact
For questions, support, or collaborations, please open an issue on the GitHub Issues page or reach out via email.
