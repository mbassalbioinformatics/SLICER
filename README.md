# SLICER: Sequenced Long-read Identifier, Cutter, Extractor, and Reporter

**A bioinformatics pipeline for analyzing complex engineered DNA constructs from PacBio long-read sequencing data, specializing in Golden Gate assemblies and *de novo* reference generation.**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

[Link to Publication - *Nature Computational Science* / *Briefings in Bioinformatics* (Coming Soon!)] [Link to Wiki](https://github.com/your-username/slicer/wiki) [Link to Issues](https://github.com/your-username/slicer/issues) 

## Overview

SLICER (Sequenced Long-read Identifier of Complex Element Regions) is a robust bioinformatics tool designed to process and analyze Pacific Biosciences (PacBio) long-read sequencing data, particularly from libraries of engineered DNA constructs such as those generated by Golden Gate assembly.

Modern synthetic biology and genome editing workflows often involve creating complex DNA constructs (e.g., plasmids, viral vectors) with multiple functional elements - such as Golden Gate Assemblies. Validating these constructs, especially when pooled or barcoded, presents significant bioinformatic challenges.

SLICER addresses these challenges by:

* **Dynamically Identifying Elements:** Accurately locating and extracting user-defined "anchor" sequences and the intervening regions of interest (ROIs), such as barcodes and core sequences, on a per-read basis. This accommodates positional variability common in engineered constructs.
* **Robust Demultiplexing:** Assigning reads to their respective constructs, even in complex, pooled libraries.
* ***De Novo* Reference Prediction:** Uniquely, SLICER can generate reference sequences directly from the sequencing reads when prior references are unavailable or incomplete. It offers two distinct algorithms for this:
    * **Slope Method:** Leverages read count disparities to identify true sequences.
    * **Distance Method:** Uses Hamming and Levenshtein distances for sequence clustering.
* **Comprehensive Analysis & Reporting:** Providing detailed statistics on read processing, filtering, alignment quality, and quantification of constructs.

![fig1_design_schematic](https://github.com/user-attachments/assets/0ed6cac6-08bb-4761-bde1-4134805533e2)
# Figure 1: Library design recognised by SLICER.

![fig2_workflow](https://github.com/user-attachments/assets/38f68a1b-648b-435d-9cc3-8e2a42228c2b)
# Figure 2: Simplied overview of SLICER's workflow


## Key Features

* **Long-Read Optimized:** Specifically designed for long-read sequenced molecules.
* **Anchor-Based Element Extraction:** Flexible identification of barcodes and core sequences using user-defined flanking sequences.
* **Reference-Based Analysis:** Supports analysis using a user-provided FASTA reference file.
* ***De Novo* Reference Generation:** Powerful "Slope" and "Distance" methods to create references when none exist.
* **Comprehensive Filtering:** Stringent read filtering based on anchor presence and barcode length consistency.
* **Alignment & Quantification:** Utilizes Minimap2 for alignment and provides detailed quantification reports using Qualimap2.
* **Detailed Reporting:** Generates statistics, Venn diagrams for filtering, and barcode/construct count summaries.
* **Command-Line Interface:** Flexible operation with clear arguments.
* **Open Source:** Free for academic use. Reach out if you require to use SLICER in comercial applications/research.

## Quick Start

### Main Prerequisites

* Python 3.x
* Minimap2
* SAMtools
* BamTools
* Qualimap

* Its ~strongly~ recommended to just use the installation script with the precompiled yml files.

### Installation

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/mbassalbioinformatics/slicer.git](https://github.com/mbassalbioinformatics/slicer.git)
    cd slicer
    ```

2.  **Run the installation script (recommended):**
    ```bash
    python slicer_installer.py
    ```
    
### Basic Usage

Prepare your input files:
* An unaligned BAM (`.ubam`) or compressed FASTQ (`.fq.gz`) file from PacBio sequencing.
* A configuration file (e.g., `config.tsv`) specifying anchor sequences and other parameters.

**Example `config.tsv`:**
```tsv
input	/path/to/your/pacbio_reads.bam
outdir	/path/to/output_directory/
setname	my_experiment
# mapref	/path/to/your/reference.fasta  (Optional: provide if you have a reference)
# autoref	slope                          (Default if mapref not provided; or use 'distance')
thread	8
config	1                                # Corresponds to Design 1 in Figure 1 of the manuscript
lfs	GTAATGTGGAAAGGACGAAACACCGCACCG     # Example Left Flanking Sequence
rfs	GTTTCTTGAAAAAGTGGCACCGAGTCGGTA     # Example Right Flanking Sequence
bbs	AGGAGCCACCATGGCCCCAAAGAAGAAGCG     # Example Right Backbone Start Sequence
slen	20                               # Length of anchor sequences to match
